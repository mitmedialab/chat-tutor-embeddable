import{S as O,i as R,s as A,a as L,e as f,b as h,c as y,B as D,d as u,f as S,l as B,n as b,g as v,h as I,w as _,x as w,t as k,j as J,o as x,y as M,k as W,z as F,F as H,v as P}from"./index-3_OAagAQ.js";import{I as q}from"./Input-2uYl84YI.js";import{M as E}from"./MessageContainer-1ZPi3RPY.js";import{s as G}from"./Message-b8ae_58A.js";function K(t){L(t,"svelte-191tpfn",'@import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400&family=Rethink+Sans&display=block");.container.svelte-191tpfn{font-family:"Rethink Sans", sans-serif;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr;font-size:1.5rem;padding:0.5rem 1rem;border-bottom:2px solid lightgray}button.svelte-191tpfn{float:right;align-self:self-end;border-radius:10%}button.svelte-191tpfn:hover{background-color:lightgray}')}function Q(t){let e,s,i,o,g,r,a,c,m,n;return{c(){e=f("link"),s=h(),i=f("div"),o=f("div"),o.textContent="Chat Tutor",g=h(),r=f("div"),a=f("button"),c=f("span"),c.textContent="close",y(e,"rel","stylesheet"),y(e,"href","https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"),y(o,"class","title"),y(c,"class","material-symbols-outlined"),D(c,"color","red"),y(a,"class","svelte-191tpfn"),D(a,"border","1px solid red"),y(r,"class","close"),y(i,"class","container svelte-191tpfn")},m(p,d){u(document.head,e),S(p,s,d),S(p,i,d),u(i,o),u(i,g),u(i,r),u(r,a),u(a,c),m||(n=B(a,"click",t[0]),m=!0)},p:b,i:b,o:b,d(p){p&&(v(s),v(i)),v(e),m=!1,n()}}}function U(t){function e(s){I.call(this,t,s)}return[e]}class N extends O{constructor(e){super(),R(this,e,U,Q,A,{},K)}}N.__docgen={version:3,name:"Header.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[{keywords:[],visibility:"public",description:"",name:"click",parent:"button",modificators:[],locations:null}],slots:[],refs:[]};const T=()=>new Date().toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}),j=(t,{addEndpoint:e})=>(t.time_created=t.timestamp,t.chat_k="To set chat id",t.clear_number="0",fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),V=async(t,{model:e,collections:s,askEndpoint:i})=>fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation:t,selectedModel:e,multiple:!0,credential_token:"none",collection:s})}),X=t=>t.split(`

`).filter(Boolean).map(e=>{try{return JSON.parse(e.split("data: ")[1])}catch(s){return console.error(s),null}}),Y=async(t,e,s,i)=>{const o=await V(t,e);let g;const r=o.body.getReader();let a;async function c(){const m=await r.read();if(m.done)return;const n=new TextDecoder().decode(m.value),p=X(n);for(const d of p){if(d===null)continue;const{message:{valid_docs:$,content:l}}=d;a?i(l??""):a=s({sender:"Assistant",timestamp:T(),role:"assistant",content:l??"",valid_docs:g})}await c()}await c(),a?j(a,e):console.error("No message received from ChatTutor")};function Z(t){L(t,"svelte-lrimgy",`.container.svelte-lrimgy{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;max-height:99vh}.row.svelte-lrimgy{border:1px solid #ddd;border-radius:10px;box-shadow:rgba(45, 35, 66, 0.4) 0 2px 4px,
            rgba(45, 35, 66, 0.3) 0 7px 13px -3px,
            #ddd 0 -3px 0 inset}`)}function ee(t){let e,s,i,o,g,r,a,c,m,n,p,d;o=new N({}),o.$on("click",t[5]);let $={};return a=new E({props:$}),t[6](a),n=new q({}),n.$on("send",t[2]),{c(){e=f("div"),s=f("div"),i=f("div"),_(o.$$.fragment),g=h(),r=f("div"),_(a.$$.fragment),c=h(),m=f("div"),_(n.$$.fragment),y(s,"class","row svelte-lrimgy"),y(m,"class","row svelte-lrimgy"),y(e,"class","container svelte-lrimgy")},m(l,C){S(l,e,C),u(e,s),u(s,i),w(o,i,null),u(s,g),u(s,r),w(a,r,null),u(e,c),u(e,m),w(n,m,null),d=!0},p(l,[C]){const z={};a.$set(z)},i(l){d||(k(o.$$.fragment,l),k(a.$$.fragment,l),k(n.$$.fragment,l),l&&(p||J(()=>{p=H(e,G,{duration:100}),p.start()})),d=!0)},o(l){x(o.$$.fragment,l),x(a.$$.fragment,l),x(n.$$.fragment,l),d=!1},d(l){l&&v(e),M(o),t[6](null),M(a),M(n)}}}function te(t,e,s){let{initialMessage:i}=e,{configuration:o}=e;const g=W();let r;const a=async n=>{const p=r.addMessage({sender:"Student",role:"user",content:n.detail.message,timestamp:T()});await j(p,o),await Y(r.getAll(),o,d=>r.addMessage(d),d=>r.appendLastMessageContent(d)),n.detail.onResponse()};F(()=>{i&&r.addMessage({sender:"Assistant",role:"assistant",content:i,timestamp:T()})});const c=()=>g("close");function m(n){P[n?"unshift":"push"](()=>{r=n,s(0,r)})}return t.$$set=n=>{"initialMessage"in n&&s(3,i=n.initialMessage),"configuration"in n&&s(4,o=n.configuration)},[r,g,a,i,o,c,m]}class ne extends O{constructor(e){super(),R(this,e,te,ee,A,{initialMessage:3,configuration:4},Z)}}ne.__docgen={version:3,name:"Window.svelte",data:[{visibility:"public",description:null,keywords:[],name:"initialMessage",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"any",type:"any"}},{visibility:"public",description:null,keywords:[],name:"configuration",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"any",type:"any"}}],computed:[],methods:[],components:[],description:null,keywords:[],events:[{visibility:"public",description:null,keywords:[],name:"close"}],slots:[],refs:[]};export{ne as W};
