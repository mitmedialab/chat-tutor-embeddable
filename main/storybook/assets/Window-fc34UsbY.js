import{S as D,i as O,s as R,a as A,e as f,b as h,c as v,B as z,d as u,f as S,l as B,n as b,g as y,h as I,w as k,x as _,t as w,j as J,o as x,y as M,k as W,z as F,F as H,v as P}from"./index-Z1Yh0Bcu.js";import{I as q}from"./Input-jwC6Wr2y.js";import{M as E}from"./MessageContainer-GrDBFunC.js";import{s as G}from"./Message-CxYaZ5da.js";function K(t){A(t,"svelte-zksmvm",'@import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400&family=Rethink+Sans&display=block");.container.svelte-zksmvm{color:black;font-family:"Rethink Sans", sans-serif;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr;font-size:1.5rem;padding:0.5rem 1rem;border-bottom:2px solid lightgray;background-color:white}button.svelte-zksmvm{float:right;align-self:self-end;border-radius:10%}button.svelte-zksmvm:hover{background-color:lightgray}')}function Q(t){let e,n,i,o,g,r,a,c,m,s;return{c(){e=f("link"),n=h(),i=f("div"),o=f("div"),o.textContent="Chat Tutor",g=h(),r=f("div"),a=f("button"),c=f("span"),c.textContent="close",v(e,"rel","stylesheet"),v(e,"href","https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"),v(o,"class","title"),v(c,"class","material-symbols-outlined"),z(c,"color","red"),v(a,"class","svelte-zksmvm"),z(a,"border","1px solid red"),v(r,"class","close"),v(i,"class","container svelte-zksmvm")},m(p,d){u(document.head,e),S(p,n,d),S(p,i,d),u(i,o),u(i,g),u(i,r),u(r,a),u(a,c),m||(s=B(a,"click",t[0]),m=!0)},p:b,i:b,o:b,d(p){p&&(y(n),y(i)),y(e),m=!1,s()}}}function U(t){function e(n){I.call(this,t,n)}return[e]}class L extends D{constructor(e){super(),O(this,e,U,Q,R,{},K)}}L.__docgen={version:3,name:"Header.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[{keywords:[],visibility:"public",description:"",name:"click",parent:"button",modificators:[],locations:null}],slots:[],refs:[]};const T=()=>new Date().toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}),N=(t,{addEndpoint:e})=>(t.time_created=t.timestamp,t.chat_k="To set chat id",t.clear_number="0",fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),V=async(t,{model:e,collections:n,askEndpoint:i})=>fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation:t,selectedModel:e,multiple:!0,credential_token:"none",collection:n})}),X=t=>t.split(`

`).filter(Boolean).map(e=>{try{return JSON.parse(e.split("data: ")[1])}catch(n){return console.error(n),null}}),Y=async(t,e,n,i)=>{const o=await V(t,e);let g;const r=o.body.getReader();let a;async function c(){const m=await r.read();if(m.done)return;const s=new TextDecoder().decode(m.value),p=X(s);for(const d of p){if(d===null)continue;const{message:{valid_docs:$,content:l}}=d;a?i(l??""):a=n({sender:"Assistant",timestamp:T(),role:"assistant",content:l??"",valid_docs:g})}await c()}await c(),a?N(a,e):console.error("No message received from ChatTutor")};function Z(t){A(t,"svelte-1dxsg4r",`.container.svelte-1dxsg4r{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;max-height:99vh;row-gap:10px}.row.svelte-1dxsg4r{border:1px solid #ddd;border-radius:10px;box-shadow:rgba(45, 35, 66, 0.4) 0 2px 4px,
            rgba(45, 35, 66, 0.3) 0 7px 13px -3px,
            #ddd 0 -3px 0 inset}`)}function ee(t){let e,n,i,o,g,r,a,c,m,s,p,d;o=new L({}),o.$on("click",t[5]);let $={};return a=new E({props:$}),t[6](a),s=new q({}),s.$on("send",t[2]),{c(){e=f("div"),n=f("div"),i=f("div"),k(o.$$.fragment),g=h(),r=f("div"),k(a.$$.fragment),c=h(),m=f("div"),k(s.$$.fragment),v(n,"class","row svelte-1dxsg4r"),v(m,"class","row svelte-1dxsg4r"),v(e,"class","container svelte-1dxsg4r")},m(l,C){S(l,e,C),u(e,n),u(n,i),_(o,i,null),u(n,g),u(n,r),_(a,r,null),u(e,c),u(e,m),_(s,m,null),d=!0},p(l,[C]){const j={};a.$set(j)},i(l){d||(w(o.$$.fragment,l),w(a.$$.fragment,l),w(s.$$.fragment,l),l&&(p||J(()=>{p=H(e,G,{duration:100}),p.start()})),d=!0)},o(l){x(o.$$.fragment,l),x(a.$$.fragment,l),x(s.$$.fragment,l),d=!1},d(l){l&&y(e),M(o),t[6](null),M(a),M(s)}}}function te(t,e,n){let{initialMessage:i}=e,{configuration:o}=e;const g=W();let r;const a=async s=>{const p=r.addMessage({sender:"Student",role:"user",content:s.detail.message,timestamp:T()});await N(p,o),await Y(r.getAll(),o,d=>r.addMessage(d),d=>r.appendLastMessageContent(d)),s.detail.onResponse()};F(()=>{i&&r.addMessage({sender:"Assistant",role:"assistant",content:i,timestamp:T()})});const c=()=>g("close");function m(s){P[s?"unshift":"push"](()=>{r=s,n(0,r)})}return t.$$set=s=>{"initialMessage"in s&&n(3,i=s.initialMessage),"configuration"in s&&n(4,o=s.configuration)},[r,g,a,i,o,c,m]}class se extends D{constructor(e){super(),O(this,e,te,ee,R,{initialMessage:3,configuration:4},Z)}}se.__docgen={version:3,name:"Window.svelte",data:[{visibility:"public",description:null,keywords:[],name:"initialMessage",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"any",type:"any"}},{visibility:"public",description:null,keywords:[],name:"configuration",kind:"let",static:!1,readonly:!1,type:{kind:"type",text:"any",type:"any"}}],computed:[],methods:[],components:[],description:null,keywords:[],events:[{visibility:"public",description:null,keywords:[],name:"close"}],slots:[],refs:[]};export{se as W};
